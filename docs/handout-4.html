<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EC910 - Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EC910</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lecture-handouts" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lecture Handouts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lecture-handouts">    
        <li>
    <a class="dropdown-item" href="./handout-1.html">
 <span class="dropdown-text">Handout 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-2.html">
 <span class="dropdown-text">Handout 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-3.html">
 <span class="dropdown-text">Handout 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-4.html">
 <span class="dropdown-text">Handout 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-problem-sets" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Problem Sets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-problem-sets">    
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1.html">
 <span class="dropdown-text">Problem Set 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1-solutions.html">
 <span class="dropdown-text">Problem Set 1 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2.html">
 <span class="dropdown-text">Problem Set 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2-solutions.html">
 <span class="dropdown-text">Problem Set 2 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-3.html">
 <span class="dropdown-text">Problem Set 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-additional-material" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Additional Material</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-additional-material">    
        <li>
    <a class="dropdown-item" href="./material-cef.html">
 <span class="dropdown-text">Conditional Expectation Function</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-interpretation.html">
 <span class="dropdown-text">Interpreting Linear Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-dummy.html">
 <span class="dropdown-text">Dummy Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-linearalgebra.html">
 <span class="dropdown-text">Linear Algebra</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#linear-hypotheses" id="toc-linear-hypotheses" class="nav-link" data-scroll-target="#linear-hypotheses"><span class="header-section-number">2</span> Linear Hypotheses</a></li>
  <li><a href="#distribution-under-h_0" id="toc-distribution-under-h_0" class="nav-link" data-scroll-target="#distribution-under-h_0"><span class="header-section-number">3</span> Distribution under <span class="math inline">\(H_0\)</span></a></li>
  <li><a href="#single-linear-hypothesis" id="toc-single-linear-hypothesis" class="nav-link" data-scroll-target="#single-linear-hypothesis"><span class="header-section-number">4</span> Single linear hypothesis</a>
  <ul class="collapse">
  <li><a href="#asymptotic-distribution" id="toc-asymptotic-distribution" class="nav-link" data-scroll-target="#asymptotic-distribution"><span class="header-section-number">4.1</span> Asymptotic distribution</a></li>
  </ul></li>
  <li><a href="#multiple-linear-hypotheses" id="toc-multiple-linear-hypotheses" class="nav-link" data-scroll-target="#multiple-linear-hypotheses"><span class="header-section-number">5</span> Multiple Linear Hypotheses</a>
  <ul class="collapse">
  <li><a href="#asymptotic-distribution-1" id="toc-asymptotic-distribution-1" class="nav-link" data-scroll-target="#asymptotic-distribution-1"><span class="header-section-number">5.1</span> Asymptotic distribution</a></li>
  </ul></li>
  <li><a href="#restricted-ols" id="toc-restricted-ols" class="nav-link" data-scroll-target="#restricted-ols"><span class="header-section-number">6</span> Restricted OLS</a></li>
  <li><a href="#heteroskedasticity" id="toc-heteroskedasticity" class="nav-link" data-scroll-target="#heteroskedasticity"><span class="header-section-number">7</span> Heteroskedasticity</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8</span> References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="handout-4.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hypothesis Testing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>In this handout we will see how to test linear hypotheses. These could be,</p>
<ul>
<li>single hypothesis concerning single parameter;</li>
<li>single hypothesis concerning multiple parameters;</li>
<li>multiple hypothesis concerning more than one parameter.</li>
</ul>
<p>Further reading can be found in:</p>
<ul>
<li>Section 7.1-7.4 of <span class="citation" data-cites="cameron2005">Cameron and Trivedi (<a href="#ref-cameron2005" role="doc-biblioref">2005</a>)</span></li>
<li>Section 6.2 &amp; 6.3 of <span class="citation" data-cites="verbeek2017">Verbeek (<a href="#ref-verbeek2017" role="doc-biblioref">2017</a>)</span></li>
</ul>
</section>
<section id="linear-hypotheses" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="linear-hypotheses"><span class="header-section-number">2</span> Linear Hypotheses</h2>
<p>Assume that the underlying model is linear in parameters, <span class="math display">\[
  Y = X\beta + u
\]</span> Consider the linear hypothesis, <span class="math display">\[
  R\beta = r
\]</span> where <span class="math inline">\(R\)</span> is an <span class="math inline">\(q\times k\)</span>, non-random matrix and <span class="math inline">\(r\)</span> a <span class="math inline">\(q\times 1\)</span> non-random vector of constants.</p>
<p>For example, consider the linear model from Problem Set 2, <span class="math display">\[
Y = \beta_1 + \beta_2X_2 + \beta_3X_3 + \beta_4X_4 + \beta_5X_5 + u
\]</span> we can express the single (<span class="math inline">\(q=1\)</span>) linear hypothesis <span class="math inline">\(H_0: \beta_2 = \beta_3 \Rightarrow\beta_2-\beta_3 = 0\)</span> as <span class="math display">\[
H_0: R\beta = \begin{bmatrix}0&amp;1&amp;-1&amp;0&amp;0\end{bmatrix}\begin{bmatrix}\beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \\ \beta_5\end{bmatrix} = 0
\]</span> In the case of a single linear hypothesis, we can also use the notation <span class="math inline">\(c'\beta = r\)</span> where <span class="math inline">\(c\)</span> is a <span class="math inline">\(k\times 1\)</span> non-random vector.</p>
<p>We can express the multiple (<span class="math inline">\(q=2\)</span>) linear hypotheses from this exercise <span class="math display">\[
H_0: \beta_2 = \beta_3\quad\text{and}\quad\beta_4 + \beta_5 = 1
\]</span> as, <span class="math display">\[
R\beta = \begin{bmatrix}0&amp;1&amp;-1&amp;0&amp;0 \\ 0&amp;0&amp;0&amp;1&amp;1\end{bmatrix}\begin{bmatrix}\beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \\ \beta_5\end{bmatrix} = \begin{bmatrix}0 \\1 \end{bmatrix}
\]</span></p>
</section>
<section id="distribution-under-h_0" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="distribution-under-h_0"><span class="header-section-number">3</span> Distribution under <span class="math inline">\(H_0\)</span></h2>
<p>Let us assume the CLRM assumptions, including normality and homoskedasticity</p>
<ul>
<li><strong>CLRM 5</strong>: <span class="math inline">\(u|X \sim N(0,\sigma^2 I_n)\)</span></li>
</ul>
<p>We know that under these assumptions the OLS estimator is normally distributed,</p>
<p><span class="math display">\[
\hat{\beta}|X \sim N(\beta,\sigma^2 (X'X)^{-1})
\]</span></p>
<p>This implies that,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
R\hat{\beta}|X \sim N(R\beta,\sigma^2 R(X'X)^{-1}R')
\]</span></p>
<p><strong>Under the null hypothesis</strong>, <span class="math inline">\(H_0: R\beta = r\)</span>,</p>
<p><span class="math display">\[
R\hat{\beta}|X \sim N(r,\sigma^2 R(X'X)^{-1}R')
\]</span> Frpm Handout 3, we know the asymptotic distribution of <span class="math inline">\(\hat{\beta}\)</span> is normal, even if the (conditional) finite sample distribution of <span class="math inline">\(u\)</span> is not. Applying the Delta Method (see Handout 2) to this result,</p>
<p><span class="math display">\[
  \sqrt{n} (R\hat{\beta}_n-R\beta)\rightarrow_d N(0,\sigma^2R(E[X_1X_1'])^{-1}R')\qquad\text{as}\quad n\rightarrow\infty
\]</span></p>
<p>Which means that, <strong>under <span class="math inline">\(H_0\)</span></strong>,</p>
<p><span class="math display">\[
  \sqrt{n} (R\hat{\beta}_n-r)\rightarrow_d N(0,\sigma^2R(E[X_1X_1'])^{-1}R')\qquad\text{as}\quad n\rightarrow\infty
\]</span></p>
</section>
<section id="single-linear-hypothesis" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="single-linear-hypothesis"><span class="header-section-number">4</span> Single linear hypothesis</h2>
<p>Assuming CLRM 5, we know that for any <span class="math inline">\(k\times 1\)</span> non-random vector <span class="math inline">\(c\)</span>,</p>
<p><span class="math display">\[
c'\hat{\beta}|X \sim N(c'\beta,\sigma^2 c'(X'X)^{-1}c)
\]</span> Which then implies, <span class="math display">\[
\frac{c'\hat{\beta}-c'\beta}{\sqrt{\sigma^2 c'(X'X)^{-1}c}}|X \sim N(0,1)
\]</span> <strong>Under</strong> <span class="math inline">\(H_0: c'\beta = r\)</span>, <span class="math display">\[
\frac{c'\hat{\beta}-r}{\sqrt{\sigma^2 c'(X'X)^{-1}c}}|X \overset{H_0}{\sim} N(0,1)
\]</span> Note, this statement is only true under <span class="math inline">\(H_0\)</span>, while the former is true always (under CLRM assumptions).</p>
<p>When evaluating against the alternative hypothesis, <span class="math inline">\(H_1: c'\beta\neq r\)</span>, the valid two-sided rejection rule is given by,</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|\text{Z-stat}|&gt;z_{1-\alpha/2}\)</span></li>
</ul>
<p>where <span class="math inline">\(\alpha\)</span> is the chosen significance level (e.g., 1%, 5%, or 10%) and <span class="math inline">\(z_{1-\alpha/2}\)</span> the <span class="math inline">\(1-\alpha/2\)</span> percentile of the standard normal distribution. We can write the two sided rejection in this way given the symmetry of the normal distribution. In general, the rejection rule is,</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\text{Z-stat}&lt;z_{\alpha/2}\)</span> or <span class="math inline">\(\text{Z-stat}&gt;z_{1-\alpha/2}\)</span></li>
</ul>
<p>However, given the symmetric of <span class="math inline">\(N(0,1)\)</span>, <span class="math inline">\(z_{\alpha/2}=-z_{1-\alpha/2}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha =&amp; Pr(Z&lt;z_{\alpha/2})+Pr(Z&gt;z_{1-\alpha/2}) \\
=&amp; Pr(Z&lt;-z_{1-\alpha/2})+Pr(Z&gt;z_{1-\alpha/2}) \\
=&amp; Pr(|Z|&gt;z_{1-\alpha/2})
\end{aligned}
\]</span> For asymmetric distributions, this is not the case, and you must write the two rejection case separately.</p>
<p>This test is valid for the true <span class="math inline">\(\sigma^2\)</span>, the homoskedastic variance of the error term. We typically do not know this variance and need to replace it with the estimator,</p>
<p><span class="math display">\[
s^2 = \frac{1}{n-k}\sum_{i=1}^{n}\hat{u}_i^2 = \frac{\hat{u}'\hat{u}}{n-k}
\]</span> where <span class="math inline">\(\hat{u}\)</span> is the residual from the linear model: <span class="math inline">\(\hat{u} = Y-X\hat{\beta}\)</span>. This begs the question: what is the conditional distribution of,</p>
<p><span class="math display">\[
\text{T-stat} = \frac{c'\hat{\beta}-r}{\sqrt{s^2 c'(X'X)^{-1}c}}
\]</span> under <span class="math inline">\(H_0\)</span>. You will know from undergraduate texts that it is <span class="math inline">\(t\)</span>-distributed. We can demonstrate this result using the idempotent properties of projection matrices.</p>
<p>First-off, substitue back in <span class="math inline">\(\sigma^2\)</span></p>
<p><span class="math display">\[
\text{T-stat} = \frac{c'\hat{\beta}-r}{\sqrt{\sigma^2 c'(X'X)^{-1}c}}\times\sqrt{\frac{s^2}{\sigma^2}}
\]</span> The T-statistic can be rewritten as the Z-statistic (which had a standard normal distribution under <span class="math inline">\(H_0\)</span>) multiplied by the square-root of the ratio of <span class="math inline">\(s^2\)</span> and <span class="math inline">\(\sigma^2\)</span>. Consider the distribution of this ratio:</p>
<p><span class="math display">\[
  \frac{s^2}{\sigma^2} = \frac{1}{n-k} \frac{\hat{u}'\hat{u}}{\sigma^2}
\]</span> We know that <span class="math inline">\(\hat{u} = M_XY = M_X u\)</span>, where <span class="math inline">\(M_X\)</span> is idempotent and symmetric. Therefore,</p>
<p><span class="math display">\[
  \frac{s^2}{\sigma^2} = \frac{1}{n-k} \frac{u'M_xu}{\sigma^2}=\frac{1}{n-k} \bigg(\frac{u}{\sigma}\bigg)'M_x\bigg(\frac{u}{\sigma}\bigg)
\]</span> By the properties of symmetric matrices (see Linear Algebra notes), <span class="math inline">\(M_X\)</span> has a eigenvector decomposition</p>
<p><span class="math display">\[
M_X = C\Lambda C' \qquad\text{where} \quad CC' = I_n
\]</span> Moreover, since <span class="math inline">\(M_X\)</span> is idempotent, all eigenvalues are <span class="math inline">\(\lambda_j\in\{0,1\}\)</span> for <span class="math inline">\(j=1,...,n\)</span>. This implies that,</p>
<p><span class="math display">\[
rank(M_X) = tr(M_X) = \sum_{j=1}^n\lambda_j
\]</span> We know that the <span class="math inline">\(rank(M_x) = rank(I_n-P_X) = rank(I_n)-rank(P_X) = n-rank(X) = n-k\)</span>. Therefore, <span class="math inline">\(M_x\)</span> has <span class="math inline">\(n-k\)</span> non-zero eigenvalues. Applying this eigenvector decomposition, we get that, <span class="math display">\[
  \frac{s^2}{\sigma^2} = \frac{1}{n-k} \bigg(\frac{u}{\sigma}\bigg)'C\Lambda C'\bigg(\frac{u}{\sigma}\bigg) = \frac{1}{n-k} \bigg(\frac{C'u}{\sigma}\bigg)'\Lambda \bigg(\frac{C'u}{\sigma}\bigg)
\]</span></p>
<p>Since <span class="math inline">\(u|X\sim N(0,\sigma^2 I_n)\)</span>,</p>
<p><span class="math display">\[
\frac{C'u}{\sigma}\sim N(0,\underbrace{C'I_nC}_{=C'C=I_n})
\]</span> Thus,</p>
<p><span class="math display">\[
  \frac{s^2}{\sigma^2} =  \frac{1}{n-k} Z'\Lambda Z = \frac{1}{n-k}\sum_{j=1}^n \lambda_jZ_j^2
\]</span> Thus, under the <span class="math inline">\(H_0\)</span>, the T-statistic’s distribution can be described by the ratio of two distributions,</p>
<p><span class="math display">\[
\text{T-stat} = \frac{Z}{\sqrt{\chi^2_{n-k}/(n-k)}} = T_{n-k}
\]</span> This distribution is known as the <span class="math inline">\(t\)</span>-distribution, with <span class="math inline">\(n-k\)</span> degrees of freedom (dof). Note, the degrees of freedom correspond to the rank of the <span class="math inline">\(M_X\)</span> matrix, since this determines the number of squared standard normal distributions summed in the denominator.</p>
<p>For a two-sided test, we reject <span class="math inline">\(H_0\)</span> when,</p>
<p><span class="math display">\[
  |\text{T-stat}| &gt;t_{n-k,1-\alpha/2}
\]</span> where <span class="math inline">\(t_{n-k,1-\alpha}\)</span> is the <span class="math inline">\(1-\alpha/2\)</span> percentile of the <span class="math inline">\(t\)</span>-distribution (with <span class="math inline">\(n-k\)</span> dof). As with the standard normal distribution, the <span class="math inline">\(t\)</span>-distribution is symmetric.</p>
<section id="asymptotic-distribution" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="asymptotic-distribution"><span class="header-section-number">4.1</span> Asymptotic distribution</h3>
<p>We will see that for <span class="math inline">\(n\)</span> large, it does not make a difference that we do not know <span class="math inline">\(\sigma^2\)</span>. The fact that <span class="math inline">\(s^2\rightarrow_p \sigma^2\)</span> (as <span class="math inline">\(n\rightarrow\infty\)</span>) means that the T-statistic will be normally distributed in the limit.</p>
<p>To demonstrate this result we just need to concern ourself with,</p>
<p><span class="math display">\[
  \frac{s^2}{\sigma^2} =  \frac{1}{n-k}\sum_{j=1}^n \lambda_jZ_j^2\sim \chi^2_{n-k}/(n-k)
\]</span> The <span class="math inline">\(E[\sum_{j=1}^n \lambda_jZ_j^2] = n-k\)</span>, since <span class="math inline">\(E[Z_1^2] = 1\)</span> for any standard normal random variable. Moreover, <span class="math inline">\(E[(\sum_{j=1}^n \lambda_jZ_j^2)^2]=2(n-k)\)</span>. Therefore, by the WLLN,</p>
<p><span class="math display">\[
\frac{1}{n-k}\sum_{j=1}^n \lambda_jZ_j^2\rightarrow_p 1
\]</span> As a result, <strong>under <span class="math inline">\(H_0\)</span></strong>,</p>
<p><span class="math display">\[
  \text{T-stat}\rightarrow_d N(0,1)
\]</span></p>
</section>
</section>
<section id="multiple-linear-hypotheses" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="multiple-linear-hypotheses"><span class="header-section-number">5</span> Multiple Linear Hypotheses</h2>
<p>We will follow similar steps to above. For any non-random <span class="math inline">\(q\times k\)</span> matrix <span class="math inline">\(R\)</span>,</p>
<p><span class="math display">\[
R\hat{\beta}|X \sim N(R\beta,\sigma^2 R(X'X)^{-1}R')
\]</span> This statement is true always, while <strong>under <span class="math inline">\(H_0: R\beta = r\)</span></strong>,</p>
<p><span class="math display">\[
R\hat{\beta}|X \overset{H_0}{\sim} N(r,\sigma^2 R(X'X)^{-1}R')
\]</span></p>
<p>To construct a scalar test static for these <span class="math inline">\(q\)</span> hypotheses we will first need to consider the distribution of,</p>
<p><span class="math display">\[
(R\hat{\beta}-r)'\big(\sigma^2 R(X'X)^{-1}R'\big)^{-1}(R\hat{\beta}-r)\sim \chi^2_{q}
\]</span> We can prove this result as follows.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Suppose <span class="math inline">\(U\sim N(0,\Omega)\)</span>. Then, <span class="math inline">\(\Omega\)</span> is a positive-definite, symmetric variance-covariance matrix. By symmetry, this matrix has an eigenvector decomposition,</p>
<p><span class="math display">\[
  \Omega = C\Lambda C' \qquad\text{where} \quad CC' = I_n
  \]</span> Given it’s positive definiteness, all eigenvalues in <span class="math inline">\(\lambda\)</span> are strictly positive. We can therefore define,</p>
<p><span class="math display">\[
  \Lambda^{1/2} = \begin{bmatrix}\lambda_1^{1/2} &amp; 0 &amp; \dots &amp; 0 \\ 0 &amp; \lambda_2^{1/2} &amp;  &amp; \\
  \vdots &amp; &amp; \ddots &amp; \\ 0 &amp; &amp; &amp; \lambda_q^{1/2}\end{bmatrix}
  \]</span> Likewise, <span class="math display">\[
  \Lambda^{-1/2} = \begin{bmatrix}\lambda_1^{-1/2} &amp; 0 &amp; \dots &amp; 0 \\ 0 &amp; \lambda_2^{-1/2} &amp;  &amp; \\
  \vdots &amp; &amp; \ddots &amp; \\ 0 &amp; &amp; &amp; \lambda_q^{-1/2}\end{bmatrix}
  \]</span> This allows us to define,</p>
<p><span class="math display">\[
  \Omega^{1/2} = C\Lambda^{1/2}C' \qquad \text{since}\quad C\Lambda^{1/2}C'C\Lambda^{1/2}C' = C\Lambda C' = \Omega
\]</span> and <span class="math display">\[
  \Omega^{-1/2} = C\Lambda^{-1/2}C' \qquad \text{since}\quad C\Lambda^{-1/2}C'C\Lambda^{-1/2}C' = C\Lambda C' = \Omega^{-1}
\]</span> Therefore,</p>
<p><span class="math display">\[
\Omega^{-1/2}U \sim N(0,\Omega^{-1/2}\Omega\Omega^{-1/2}) = N(0,I_q)
\]</span> and <span class="math display">\[
U'\Omega^{-1}U  = \sum_{j=1}^qZ_i^2\sim \chi^2_q
\]</span></p>
</div>
<p>Using this result, we can then define the F-statistic as,</p>
<p><span class="math display">\[
  \text{F-stat} = (R\hat{\beta}-r)'\big(s^2 R(X'X)^{-1}R'\big)^{-1}(R\hat{\beta}-r)/q
\]</span> where we replace the unknown <span class="math inline">\(\sigma^2\)</span> by <span class="math inline">\(s^2\)</span> and scale by <span class="math inline">\(q\)</span>, the <span class="math inline">\(rank(R)\)</span> (or number of hypotheses).</p>
<p>As above, we can rewrite this test-statistic as,</p>
<p><span class="math display">\[
\begin{aligned}
  \text{F-stat} =&amp; \frac{(R\hat{\beta}-r)'\big(\sigma^2 R(X'X)^{-1}R'\big)^{-1}(R\hat{\beta}-r)/q}{s^2/\sigma^2} \\
  \sim&amp;\frac{\chi_q/q}{\chi_{n-k}/(n-k)}\\
  =&amp;F_{q,n-k}
\end{aligned}  
\]</span> We reject <span class="math inline">\(H_0\)</span> when,</p>
<p><span class="math display">\[
  \text{F-stat} &gt;f_{q,n-k,1-\alpha}
\]</span> where <span class="math inline">\(f_{q,n-k,1-\alpha}\)</span> is the <span class="math inline">\(1-\alpha\)</span> percentile of the <span class="math inline">\(F\)</span>-distribution with dof <span class="math inline">\(q\)</span> and <span class="math inline">\(n-k\)</span>. This is a one-sided test since the F-statistic is strictly positive.</p>
<p>Note, for <span class="math inline">\(q=1\)</span>, the F-statistic is given by the square of the T-statistic.</p>
<section id="asymptotic-distribution-1" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="asymptotic-distribution-1"><span class="header-section-number">5.1</span> Asymptotic distribution</h3>
<p>As before, the replacement of <span class="math inline">\(\sigma^2\)</span> with <span class="math inline">\(s^2\)</span> has no baring on the asymptotic distribution of the test. Since, <span class="math inline">\(p \lim (s_n^2/\sigma^2) = 1\)</span>,</p>
<p><span class="math display">\[
\text{F-stat} \rightarrow_d \chi^2_{q}\qquad \text{as}\quad n\rightarrow\infty
\]</span></p>
</section>
</section>
<section id="restricted-ols" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="restricted-ols"><span class="header-section-number">6</span> Restricted OLS</h2>
<p>You will likely be familiar with a second description of the F-statistic:</p>
<p><span class="math display">\[
\text{F-stat} = \frac{(RSS_R - RSS_U)/q}{RSS_U/(n-k)}
\]</span></p>
<p>This expression is equivalent to above and can be derived by solving the restricted (ordinary) least squares problem.</p>
<p><span class="math display">\[
  \underset{b}{\min} \;(Y-Xb)'(Y-Xb) \qquad \text{s.t.}\quad Rb = r
\]</span></p>
<p>This is a constrained optimization problem that can be solved using the Lagrangian function,</p>
<p><span class="math display">\[
L(b,\lambda) = (Y-Xb)'(Y-Xb) + 2\lambda'(Rb-r)
\]</span> The F.O.C.’s (w.r.t. <span class="math inline">\(b\)</span> and <span class="math inline">\(\lambda\)</span>), state at the optimum it must be that,</p>
<p><span class="math display">\[
\begin{aligned}
0 =&amp; 2X'X\tilde{\beta}-2X'Y-2R'\tilde{\lambda} \\
0 =&amp; R\tilde{\beta}-r
\end{aligned}
\]</span></p>
<p>From (1), we have,</p>
<p><span class="math display">\[
\begin{aligned}
\tilde{\beta} =&amp; (X'X)^{-1}(X'Y-R'\tilde{\lambda}) \\
=&amp; \underbrace{(X'X)^{-1}X'Y}_\text{OLS}- (X'X)^{-1}R'\tilde{\lambda} \\
=&amp; \hat{\beta} - (X'X)^{-1}R'\tilde{\lambda}
\end{aligned}
\]</span> Pluggin this solution into (2), you get,</p>
<p><span class="math display">\[
\begin{aligned}
r =&amp; R\hat{\beta}-R(X'X)^{-1}R'\tilde{\lambda} \\
\Rightarrow \tilde{\lambda} =&amp; (R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r) \\
\Rightarrow \tilde{\beta} =&amp; \hat{\beta}- (X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r)
\end{aligned}
\]</span></p>
<p>The residuals from the restricted model are given by,</p>
<p><span class="math display">\[
\begin{aligned}
\tilde{U} =&amp; Y-X\tilde{\beta} \\
=&amp;\underbrace{Y-X\hat{\beta}}_{M_XY}+X(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r) \\
=&amp;\hat{U}+X(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r)
\end{aligned}
\]</span> The Residual Sum of Squares (RSS) from the restricted model is then given by, <span class="math display">\[
\begin{aligned}
\tilde{U}'\tilde{U} =&amp; \big(\hat{U}+X(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r)\big)'\big(\hat{U}+X(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r)\big) \\
=&amp;\hat{U}'\hat{U} + (R\hat{\beta}-r)'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r)
\end{aligned}
\]</span> The cross-product terms cancel, because <span class="math inline">\(\hat{U}'X(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r) = Y'M_XX(X'X)^{-1}R'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r) = 0\)</span>. Thus,</p>
<p><span class="math display">\[
  (R\hat{\beta}-r)'(R(X'X)^{-1}R')^{-1}(R\hat{\beta}-r) = \underbrace{\tilde{U}'\tilde{U}}_{RSS_R}-\underbrace{\hat{U}'\hat{U}}_{RSS_U}
\]</span> Since, <span class="math inline">\(s^2 = RSS_U/(n-k)\)</span>, a scalar,</p>
<p><span class="math display">\[
  \text{F-stat} = \frac{(RSS_R - RSS_U)/q}{RSS_U/(n-k)}
\]</span></p>
<p>Where <span class="math inline">\(q = dof_r-dof_u\)</span>, the difference in residual degrees of freedom for the two models.</p>
<p>You can estimate the restricted model by imposing the restrictions of <span class="math inline">\(H_0\)</span> on the model. For example, in Problem Set 2, we tested <span class="math inline">\(H_0: \beta_2 = \beta_3\)</span> <strong>and</strong> <span class="math inline">\(\beta_4 + \beta_5 = 1\)</span>, by estimating the restricted model,</p>
<p><span class="math display">\[
    (Y-X_4) = \gamma_1 + \gamma_2(X_2+X_3) + \gamma_5(X_5-X_4) + \varepsilon
\]</span> ### Testing full model</p>
<p>In the unique case where the hypothesis is given by,</p>
<p><span class="math display">\[
H_0: \beta_2 = ... = \beta_k = 0
\]</span></p>
<p>And the model includes a constant (i.e.&nbsp;<span class="math inline">\(X_1 = \mathbf{1}\)</span>). Then, the restricted model amounts to a regression of <span class="math inline">\(Y\)</span> on a constant.</p>
<p><span class="math display">\[
  RSS_R = (Y-\bar{Y})'(Y-\bar{Y}) = TSS
\]</span></p>
<p>The F-statistic can be written in terms of <span class="math inline">\(R^2\)</span> (of the unrestricted model),</p>
<p><span class="math display">\[
  \text{F-stat} = \frac{R^2/(k-1)}{(1 - R^2)/(n-k)}
\]</span></p>
<p>This is the F-statistic reported by Stata when you estimate a linear regression model.</p>
</section>
<section id="heteroskedasticity" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="heteroskedasticity"><span class="header-section-number">7</span> Heteroskedasticity</h2>
<p>Both the t- and F-tests described above have their corresponding finite sample distributions under the assumptions that the error term in the CLRM is normally distributed (conditional on X) and that its variance is homoskedastic.</p>
<p>These distributions are not valid, for the finite sample, if the error terms are heteroskedastic. However, the tests do have the same asymptotic distributions with heteroskedasticity. For this reason, you should not use the t-distribution or F-distribution if your SEs are computed assuming heteroskedasticity. Instead, use the normal and chi-squared distributions.</p>
</section>
<section id="references" class="level2" data-number="8">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">8 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-cameron2005" class="csl-entry" role="listitem">
Cameron, A Colin, and Pravin K Trivedi. 2005. <em>Microeconometrics: Methods and Applications</em>. Cambridge university press.
</div>
<div id="ref-verbeek2017" class="csl-entry" role="listitem">
Verbeek, Marno. 2017. <em>A Guide to Modern Econometrics</em>. John Wiley &amp; Sons.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If <span class="math inline">\(X\sim N(\mu,\Omega)\)</span> then the linear transformation of <span class="math inline">\(X\)</span>, <span class="math inline">\(Y = AX +b\)</span>, is distributed <span class="math inline">\(Y\sim N(A\mu+b,A\Omega A')\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>