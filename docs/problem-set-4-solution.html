<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EC910</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EC910</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lecture-handouts" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lecture Handouts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lecture-handouts">    
        <li>
    <a class="dropdown-item" href="./handout-1.html">
 <span class="dropdown-text">Handout 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-2.html">
 <span class="dropdown-text">Handout 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-3.html">
 <span class="dropdown-text">Handout 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-4.html">
 <span class="dropdown-text">Handout 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-problem-sets" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Problem Sets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-problem-sets">    
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1.html">
 <span class="dropdown-text">Problem Set 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1-solutions.html">
 <span class="dropdown-text">Problem Set 1 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2.html">
 <span class="dropdown-text">Problem Set 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2-solutions.html">
 <span class="dropdown-text">Problem Set 2 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-3.html">
 <span class="dropdown-text">Problem Set 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-3-solutions.html">
 <span class="dropdown-text">Problem Set 3 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-4.html">
 <span class="dropdown-text">Problem Set 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-additional-material" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Additional Material</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-additional-material">    
        <li>
    <a class="dropdown-item" href="./material-cef.html">
 <span class="dropdown-text">Conditional Expectation Function</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-interpretation.html">
 <span class="dropdown-text">Interpreting Linear Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-dummy.html">
 <span class="dropdown-text">Dummy Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-linearalgebra.html">
 <span class="dropdown-text">Linear Algebra</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#postamble" id="toc-postamble" class="nav-link" data-scroll-target="#postamble">Postamble</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="problem-set-4-solution.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Problem Set 4 (SOLUTIONS)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This problem set will revisit some of the material covered in Handouts 3 and 4. You will be required to work with a ‘raw’ dataset, downloaded from an online repository. For this reason, you should take care to check how the data is coded.</p>
<p>You will be using a version of the US Current Population Survey (CPS) called the <a href="https://www.nber.org/research/data/current-population-survey-cps-merged-outgoing-rotation-group-earnings-data">Merged Outgoing Rotation Group</a> (MORG). This data is compiled by the National Bureau of Economic Research (NBER) and has been used in many famous studies of the US economy. The CPS has a rather unique rotating panel design: “The monthly CPS is a rotating panel design; households are interviewed for four consecutive months, are not in the sample for the next eight months, and then are interviewed for four more consecutive months.” (<a href="https://cps.ipums.org/cps/sample_designs.shtml">source: IPUMS</a>). The NBER’s MORG keeps only the outgoing rotation group’s observations.</p>
<p>The MORG .dta files can be found at: <a href="https://data.nber.org/morg/annual/" class="uri">https://data.nber.org/morg/annual/</a>.</p>
<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<div id="09d39de5" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
</div>
<p>Create a do-file for this problem set and include a preamble that sets the directory and opens the data <strong>directly from the NBER website</strong>. Of course, this requires a good internet connection. For example,</p>
<div id="b84884fe" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">clear</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">//or, to remove all stored values (including macros, matrices, scalars, etc.) </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>*<span class="kw">clear</span> <span class="ot">all</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>* Replace <span class="ot">$rootdir</span> with the relevant path to <span class="kw">on</span> your <span class="kw">local</span> harddrive.</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cd <span class="st">"$rootdir/problem-sets/ps-4"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>cap <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> problem-<span class="kw">set</span>-4-<span class="fu">log</span>.txt, <span class="kw">replace</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"https://data.nber.org/morg/annual/morg19.dta"</span>, <span class="kw">clear</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can, of course, download the data and open it locally on your computer.</p>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<p><strong>1.</strong> Create a new variable <code>exper</code> equal to age minus (years of education + 6). This is referred to as potential years of experience. Check how each variable defines missing values before proceeding. You will need to create a years of education variable for this. Here is he the suggested code:</p>
<div id="d0c20b64" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> grade92, <span class="fu">m</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> eduyrs = .</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = .3 <span class="kw">if</span> grade92==31</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 3.2 <span class="kw">if</span> grade92==32</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 7.2 <span class="kw">if</span> grade92==33</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 7.2 <span class="kw">if</span> grade92==34</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 9  <span class="kw">if</span> grade92==35</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 10 <span class="kw">if</span> grade92==36</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 11 <span class="kw">if</span> grade92==37</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 12 <span class="kw">if</span> grade92==38</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 12 <span class="kw">if</span> grade92==39</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 13 <span class="kw">if</span> grade92==40</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 14 <span class="kw">if</span> grade92==41</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 14 <span class="kw">if</span> grade92==42</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 16 <span class="kw">if</span> grade92==43</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==44</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==45</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==46</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    lab <span class="kw">var</span> eduyrs <span class="st">"completed education"</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> grade92, <span class="kw">sum</span>(eduyrs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Highest |
      grade |
  completed |      Freq.     Percent        Cum.
------------+-----------------------------------
         31 |        814        0.28        0.28
         32 |      1,495        0.51        0.79
         33 |      3,071        1.05        1.85
         34 |      4,123        1.41        3.26
         35 |      5,244        1.80        5.06
         36 |      7,824        2.69        7.75
         37 |      9,271        3.18       10.93
         38 |      4,226        1.45       12.38
         39 |     82,795       28.41       40.79
         40 |     50,112       17.20       57.99
         41 |     12,392        4.25       62.24
         42 |     16,161        5.55       67.79
         43 |     59,438       20.40       88.19
         44 |     25,374        8.71       96.89
         45 |      3,785        1.30       98.19
         46 |      5,265        1.81      100.00
------------+-----------------------------------
      Total |    291,390      100.00
(291,390 missing values generated)
(814 real changes made)
(1,495 real changes made)
(3,071 real changes made)
(4,123 real changes made)
(5,244 real changes made)
(7,824 real changes made)
(9,271 real changes made)
(4,226 real changes made)
(82,795 real changes made)
(50,112 real changes made)
(12,392 real changes made)
(16,161 real changes made)
(59,438 real changes made)
(25,374 real changes made)
(3,785 real changes made)
(5,265 real changes made)

    Highest |
      grade |   Summary of completed education
  completed |        Mean   Std. dev.       Freq.
------------+------------------------------------
         31 |   .30000001           0         814
         32 |         3.2           0       1,495
         33 |   7.1999998           0       3,071
         34 |   7.1999998           0       4,123
         35 |           9           0       5,244
         36 |          10           0       7,824
         37 |          11           0       9,271
         38 |          12           0       4,226
         39 |          12           0      82,795
         40 |          13           0      50,112
         41 |          14           0      12,392
         42 |          14           0      16,161
         43 |          16           0      59,438
         44 |          18           0      25,374
         45 |          18           0       3,785
         46 |          18           0       5,265
------------+------------------------------------
      Total |   13.556855   2.7030576     291,390</code></pre>
</div>
</div>
<div id="7f58375c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> age, <span class="fu">m</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> exper = age-(eduyrs+6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        Age |      Freq.     Percent        Cum.
------------+-----------------------------------
         16 |      4,661        1.60        1.60
         17 |      4,630        1.59        3.19
         18 |      4,417        1.52        4.70
         19 |      4,039        1.39        6.09
         20 |      3,915        1.34        7.43
         21 |      3,996        1.37        8.81
         22 |      3,918        1.34       10.15
         23 |      3,950        1.36       11.51
         24 |      4,194        1.44       12.94
         25 |      4,185        1.44       14.38
         26 |      4,325        1.48       15.87
         27 |      4,476        1.54       17.40
         28 |      4,600        1.58       18.98
         29 |      4,633        1.59       20.57
         30 |      4,829        1.66       22.23
         31 |      4,735        1.62       23.85
         32 |      4,601        1.58       25.43
         33 |      4,748        1.63       27.06
         34 |      4,646        1.59       28.66
         35 |      4,730        1.62       30.28
         36 |      4,742        1.63       31.91
         37 |      4,848        1.66       33.57
         38 |      4,550        1.56       35.13
         39 |      4,735        1.62       36.76
         40 |      4,667        1.60       38.36
         41 |      4,503        1.55       39.90
         42 |      4,390        1.51       41.41
         43 |      4,309        1.48       42.89
         44 |      4,193        1.44       44.33
         45 |      4,253        1.46       45.79
         46 |      4,266        1.46       47.25
         47 |      4,447        1.53       48.78
         48 |      4,563        1.57       50.34
         49 |      4,698        1.61       51.96
         50 |      4,646        1.59       53.55
         51 |      4,477        1.54       55.09
         52 |      4,555        1.56       56.65
         53 |      4,523        1.55       58.20
         54 |      4,736        1.63       59.83
         55 |      5,010        1.72       61.55
         56 |      5,035        1.73       63.27
         57 |      4,976        1.71       64.98
         58 |      5,030        1.73       66.71
         59 |      5,066        1.74       68.45
         60 |      5,124        1.76       70.20
         61 |      5,067        1.74       71.94
         62 |      5,035        1.73       73.67
         63 |      4,927        1.69       75.36
         64 |      4,892        1.68       77.04
         65 |      4,554        1.56       78.60
         66 |      4,526        1.55       80.16
         67 |      4,344        1.49       81.65
         68 |      4,328        1.49       83.13
         69 |      4,100        1.41       84.54
         70 |      4,058        1.39       85.93
         71 |      4,008        1.38       87.31
         72 |      3,897        1.34       88.65
         73 |      3,147        1.08       89.73
         74 |      2,815        0.97       90.69
         75 |      2,809        0.96       91.66
         76 |      2,623        0.90       92.56
         77 |      2,373        0.81       93.37
         78 |      2,201        0.76       94.13
         79 |      1,977        0.68       94.80
         80 |      7,799        2.68       97.48
         85 |      7,340        2.52      100.00
------------+-----------------------------------
      Total |    291,390      100.00</code></pre>
</div>
</div>
<p><strong>2.</strong> Keep only those between the ages of 18 and 54. Check the distribution of `exper’ and replace any negative values to 0.</p>
<div id="612ee1fb" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">keep</span> <span class="kw">if</span> <span class="fu">inrange</span>(age,18,54)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> exper, <span class="fu">det</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> exper=0 <span class="kw">if</span> exper&lt;0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(126,352 observations deleted)

                            exper
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -6
 5%            1             -5
10%            2             -4       Obs             165,038
25%            7             -4       Sum of wgt.     165,038

50%           16                      Mean           16.50623
                        Largest       Std. dev.      10.57401
75%           25           47.7
90%           31           47.7       Variance       111.8097
95%           34           47.7       Skewness       .1296908
99%           36           47.7       Kurtosis       1.887811
(1,078 real changes made)</code></pre>
</div>
</div>
<p><strong>3.</strong> Create a categorical variable that takes on 4 values: 1 “less than High School”; 2 “High School Diploma”; 3 “some Higher Education”; 4 “Bachelors”; 5 “Postgraduate”. This variable should be based on the the <code>grade921 variable. You can find the value labels for this variable in this document: &lt;https://data.nber.org/morg/docs/cpsx.pdf&gt;. I suggest using the</code>recode<code>command, which allows you to create value labels while assigning values. Check the distributio of</code>exper` by education category.</p>
<div id="3522e5ae" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">recode</span> grade92 (31/38 = 1 <span class="st">"&lt;HS"</span>) (39 = 2 <span class="st">"HS"</span>) (40/42 = 3 <span class="st">"HS+"</span>) (43 = 4 <span class="st">"BA"</span>) (44/46 = 5 <span class="st">"PG"</span>), <span class="kw">gen</span>(educat)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> grade92 educat, <span class="fu">m</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> educat, <span class="kw">sum</span>(exper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(165,038 differences between grade92 and educat)

   Highest |
     grade |      RECODE of grade92 (Highest grade completed)
 completed |       &lt;HS         HS        HS+         BA         PG |     Total
-----------+-------------------------------------------------------+----------
        31 |       398          0          0          0          0 |       398 
        32 |       578          0          0          0          0 |       578 
        33 |     1,515          0          0          0          0 |     1,515 
        34 |     1,571          0          0          0          0 |     1,571 
        35 |     1,971          0          0          0          0 |     1,971 
        36 |     2,198          0          0          0          0 |     2,198 
        37 |     4,373          0          0          0          0 |     4,373 
        38 |     2,440          0          0          0          0 |     2,440 
        39 |         0     45,013          0          0          0 |    45,013 
        40 |         0          0     30,934          0          0 |    30,934 
        41 |         0          0      7,154          0          0 |     7,154 
        42 |         0          0      9,708          0          0 |     9,708 
        43 |         0          0          0     37,557          0 |    37,557 
        44 |         0          0          0          0     14,804 |    14,804 
        45 |         0          0          0          0      2,021 |     2,021 
        46 |         0          0          0          0      2,803 |     2,803 
-----------+-------------------------------------------------------+----------
     Total |    15,044     45,013     47,796     37,557     19,628 |   165,038 

  RECODE of |
    grade92 |
   (Highest |
      grade |          Summary of exper
 completed) |        Mean   Std. dev.       Freq.
------------+------------------------------------
        &lt;HS |    19.29665    12.82301      15,044
         HS |   17.726435   11.044222      45,013
        HS+ |   15.643589   10.806949      47,796
         BA |   15.376841   9.3440749      37,557
         PG |   15.900092   8.1569821      19,628
------------+------------------------------------
      Total |   16.514468   10.560511     165,038</code></pre>
</div>
</div>
<p><strong>4.</strong> Create the variable <code>lnwage</code> equal to the (natural) log of weekly earnings. Create a figure that shows the predicted <em>linear</em> fit of <code>lwage</code> against <code>exper</code>, by <code>educat</code>. Try to place all 5 fitted lines in the same graph.</p>
<div id="b07b368c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> lnwage = <span class="fu">ln</span>(earnwke)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">twoway</span> (<span class="kw">lfit</span> lnwage exper <span class="kw">if</span> educat==1) (<span class="kw">lfit</span> lnwage exper <span class="kw">if</span> educat==2)  (<span class="kw">lfit</span> lnwage exper <span class="kw">if</span> educat==3) (<span class="kw">lfit</span> lnwage exper <span class="kw">if</span> educat==4) (<span class="kw">lfit</span> lnwage exper <span class="kw">if</span> educat==5) , <span class="bn">legend</span>(<span class="kw">order</span>(1 <span class="st">"&lt;HS"</span> 2 <span class="st">"HS"</span> 3 <span class="st">"HS+"</span> 4 <span class="st">"BA"</span> 5 <span class="st">"PG"</span>) pos(6) <span class="fu">r</span>(1)) <span class="bn">xtitle</span>(Years <span class="kw">of</span> experience) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(49,686 missing values generated)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="problem-set-4-solution_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>5.</strong> Estimate a linear regression model that allows the slope coefficient on <code>exper</code> and constant term to vary by education category (<code>educat</code>). Let the base (excluded) education category be 2 “High School diploma”.</p>
<p><span class="math display">\[
  \ln(Wage_i) = \alpha + \sum_{j\neq2}\psi_j \mathbf{1}\{Educat_i=j\} + \beta Exper_i + \sum_{j\neq2}\gamma_j Exper_i\times\mathbf{1}\{Educat_i=j\}+\upsilon_i
\]</span></p>
<div id="1e4ee6c5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage ib2.educat##c.exper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Source |       SS           df       MS      Number of obs   =   115,352
-------------+----------------------------------   F(9, 115342)    =   4039.95
       Model |  17435.5509         9  1937.28343   Prob &gt; F        =    0.0000
    Residual |  55310.0589   115,342  .479530951   R-squared       =    0.2397
-------------+----------------------------------   Adj R-squared   =    0.2396
       Total |  72745.6098   115,351   .63064568   Root MSE        =    .69248

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      educat |
        &lt;HS  |  -.3882762   .0178644   -21.73   0.000    -.4232902   -.3532622
        HS+  |  -.0839435   .0104229    -8.05   0.000    -.1043722   -.0635149
         BA  |   .6145964   .0109763    55.99   0.000     .5930831    .6361097
         PG  |   .9055692   .0141961    63.79   0.000      .877745    .9333933
             |
       exper |   .0182621   .0003709    49.24   0.000     .0175351    .0189891
             |
      educat#|
     c.exper |
        &lt;HS  |    .001037   .0007627     1.36   0.174     -.000458    .0025319
        HS+  |   .0095156   .0005186    18.35   0.000     .0084991    .0105321
         BA  |  -.0032067   .0005743    -5.58   0.000    -.0043324   -.0020811
         PG  |  -.0051215   .0007698    -6.65   0.000    -.0066302   -.0036128
             |
       _cons |   6.101809   .0077485   787.48   0.000     6.086622    6.116996
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p><strong>6.</strong> Show that after 13 years of experience, those with some Higer Education (but no Bachelors), out earn those with just a high school diploma. You can assume that there are is a 2 year difference between the experience (education).</p>
<div id="cb1e11d7" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dis _b[exper]*14</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dis (_b[exper] + _b[3.educat#exper])*12 + _b[3.educat]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dis _b[exper]*15</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dis (_b[exper] + _b[3.educat#exper])*13 + _b[3.educat]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>.25566943
.24938901
.27393153
.27716672</code></pre>
</div>
</div>
<p><strong>7.</strong> Use the post-estimation <code>test</code> command to test the null hypothesis: <span class="math inline">\(H_0: 15\beta = 13(\beta+\gamma_3)+\psi_3\)</span>.</p>
<div id="b4d62b81" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span> exper*15 = (exper+3.educat#exper)*13+3.educat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ( 1)  - 3.educat + 2*exper - 13*3.educat#c.exper = 0

       F(  1,115342) =    0.32
            Prob &gt; F =    0.5734</code></pre>
</div>
</div>
<p><strong>8.</strong> Estimate a transformed version of the above model allowing you to test the above hypothesis using the coefficient from a single regressor. That is, the resulting test should be a simple t-test of <span class="math inline">\(H_0: \phi=0\)</span>, where <span class="math inline">\(\phi\)</span> is the coefficient on the interaction of <code>exper</code> and a dummy variable for <code>educat</code>=3. This will be easier to do if you estimate the model using only the relevant sample: those with High School diplomas and some Higher Education. I suggest avoiding the use of factor notation to create the dummy variables and interaction terms for this exercise. For example, the following should replicate the relevant coefficients from Q5.</p>
<div id="959c02e5" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> hasHE = educat==3 <span class="kw">if</span> <span class="fu">inlist</span>(educat,2,3)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> hasHEexp = hasHE*exper</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage exper hasHE hasHEexp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(72,229 missing values generated)
(72,229 missing values generated)

      Source |       SS           df       MS      Number of obs   =    62,811
-------------+----------------------------------   F(3, 62807)     =   2860.46
       Model |  4000.16053         3  1333.38684   Prob &gt; F        =    0.0000
    Residual |  29277.0845    62,807  .466143655   R-squared       =    0.1202
-------------+----------------------------------   Adj R-squared   =    0.1202
       Total |  33277.2451    62,810  .529808073   Root MSE        =    .68275

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       exper |   .0182621   .0003657    49.94   0.000     .0175453    .0189789
       hasHE |  -.0839435   .0102764    -8.17   0.000    -.1040852   -.0638019
    hasHEexp |   .0095156   .0005113    18.61   0.000     .0085134    .0105178
       _cons |   6.101809   .0076396   798.71   0.000     6.086835    6.116782
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div id="9765b62f" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> experR = exper+hasHEexp*2/13</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> hasHER = hasHE-hasHEexp/13</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage experR hasHER hasHEexp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(72,229 missing values generated)
(72,229 missing values generated)

      Source |       SS           df       MS      Number of obs   =    62,811
-------------+----------------------------------   F(3, 62807)     =   2860.46
       Model |  4000.16052         3  1333.38684   Prob &gt; F        =    0.0000
    Residual |  29277.0845    62,807  .466143655   R-squared       =    0.1202
-------------+----------------------------------   Adj R-squared   =    0.1202
       Total |  33277.2451    62,810  .529808073   Root MSE        =    .68275

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      experR |   .0182621   .0003657    49.94   0.000     .0175453    .0189789
      hasHER |  -.0839435   .0102764    -8.17   0.000    -.1040852   -.0638019
    hasHEexp |   .0002489   .0004358     0.57   0.568    -.0006053     .001103
       _cons |   6.101809   .0076396   798.71   0.000     6.086835    6.116782
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p><strong>9.</strong> Verify that the F-statistic from Q7 is the square of the above T-statistic.</p>
<div id="d37e3d39" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dis (_b[hasHEexp]/_se[hasHEexp])^2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>.32610143</code></pre>
</div>
</div>
<p><strong>10.</strong> Use the restricted OLS approach to replicate the F-statistic and p-value from Q7.</p>
<div id="595448b1" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage exper hasHE hasHEexp</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> RSSu = <span class="fu">e</span>(rss)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> DOFu = <span class="fu">e</span>(df_r)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage experR hasHER </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> RSSr = <span class="fu">e</span>(rss)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> DOFr = <span class="fu">e</span>(df_r)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> Fstat = ((RSSr-RSSu)/(DOFr-DOFu))/(RSSu/DOFu)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> pval = <span class="fu">Ftail</span>(1,DOFu,Fstat)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> <span class="ot">list</span> Fstat pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Source |       SS           df       MS      Number of obs   =    62,811
-------------+----------------------------------   F(3, 62807)     =   2860.46
       Model |  4000.16053         3  1333.38684   Prob &gt; F        =    0.0000
    Residual |  29277.0845    62,807  .466143655   R-squared       =    0.1202
-------------+----------------------------------   Adj R-squared   =    0.1202
       Total |  33277.2451    62,810  .529808073   Root MSE        =    .68275

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       exper |   .0182621   .0003657    49.94   0.000     .0175453    .0189789
       hasHE |  -.0839435   .0102764    -8.17   0.000    -.1040852   -.0638019
    hasHEexp |   .0095156   .0005113    18.61   0.000     .0085134    .0105178
       _cons |   6.101809   .0076396   798.71   0.000     6.086835    6.116782
------------------------------------------------------------------------------

      Source |       SS           df       MS      Number of obs   =    62,811
-------------+----------------------------------   F(2, 62808)     =   4290.58
       Model |  4000.00851         2  2000.00425   Prob &gt; F        =    0.0000
    Residual |  29277.2366    62,808  .466138654   R-squared       =    0.1202
-------------+----------------------------------   Adj R-squared   =    0.1202
       Total |  33277.2451    62,810  .529808073   Root MSE        =    .68274

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      experR |   .0182233   .0003593    50.71   0.000      .017519    .0189277
      hasHER |  -.0882792   .0069253   -12.75   0.000    -.1018527   -.0747056
       _cons |   6.104077   .0065255   935.42   0.000     6.091287    6.116867
------------------------------------------------------------------------------
     Fstat =  .32612066
      pval =   .5679544</code></pre>
</div>
</div>
<p><strong>11.</strong> Use the restricted OLS approach to test the following hypothesis corresponding to the model in Q5:</p>
<p><span class="math display">\[
H_0: \gamma_j = 0\qquad \text{for}\quad j=1,3,4,5
\]</span> Compute the F-statistic and p-value. Verify your result using the post-estimation <code>test</code> command.</p>
<div id="fe08e60b" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage ib2.educat##c.exper</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> RSSu = <span class="fu">e</span>(rss)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> DOFu = <span class="fu">e</span>(df_r)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage ib2.educat exper </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> RSSr = <span class="fu">e</span>(rss)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> DOFr = <span class="fu">e</span>(df_r)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> Fstat = ((RSSr-RSSu)/(DOFr-DOFu))/(RSSu/DOFu)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> pval = <span class="fu">Ftail</span>(DOFr-DOFu,DOFu,Fstat)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> <span class="ot">list</span> Fstat pval</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>** verify</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lnwage ib2.educat##c.exper</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span> 1.educat#exper 3.educat#exper 4.educat#exper 5.educat#exper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Source |       SS           df       MS      Number of obs   =   115,352
-------------+----------------------------------   F(9, 115342)    =   4039.95
       Model |  17435.5509         9  1937.28343   Prob &gt; F        =    0.0000
    Residual |  55310.0589   115,342  .479530951   R-squared       =    0.2397
-------------+----------------------------------   Adj R-squared   =    0.2396
       Total |  72745.6098   115,351   .63064568   Root MSE        =    .69248

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      educat |
        &lt;HS  |  -.3882762   .0178644   -21.73   0.000    -.4232902   -.3532622
        HS+  |  -.0839435   .0104229    -8.05   0.000    -.1043722   -.0635149
         BA  |   .6145964   .0109763    55.99   0.000     .5930831    .6361097
         PG  |   .9055692   .0141961    63.79   0.000      .877745    .9333933
             |
       exper |   .0182621   .0003709    49.24   0.000     .0175351    .0189891
             |
      educat#|
     c.exper |
        &lt;HS  |    .001037   .0007627     1.36   0.174     -.000458    .0025319
        HS+  |   .0095156   .0005186    18.35   0.000     .0084991    .0105321
         BA  |  -.0032067   .0005743    -5.58   0.000    -.0043324   -.0020811
         PG  |  -.0051215   .0007698    -6.65   0.000    -.0066302   -.0036128
             |
       _cons |   6.101809   .0077485   787.48   0.000     6.086622    6.116996
------------------------------------------------------------------------------

      Source |       SS           df       MS      Number of obs   =   115,352
-------------+----------------------------------   F(5, 115346)    =   7085.67
       Model |  17093.4651         5  3418.69301   Prob &gt; F        =    0.0000
    Residual |  55652.1448   115,346  .482480058   R-squared       =    0.2350
-------------+----------------------------------   Adj R-squared   =    0.2349
       Total |  72745.6098   115,351   .63064568   Root MSE        =    .69461

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      educat |
        &lt;HS  |  -.3724213   .0090073   -41.35   0.000    -.3900754   -.3547671
        HS+  |   .0726614   .0055618    13.06   0.000     .0617604    .0835624
         BA  |   .5714202   .0057563    99.27   0.000     .5601379    .5827025
         PG  |   .8295498   .0068114   121.79   0.000     .8161996    .8428999
             |
       exper |   .0201711   .0002025    99.60   0.000     .0197742    .0205681
       _cons |   6.067685   .0054116  1121.24   0.000     6.057079    6.078292
------------------------------------------------------------------------------
     Fstat =  178.34399
      pval =  1.32e-152

      Source |       SS           df       MS      Number of obs   =   115,352
-------------+----------------------------------   F(9, 115342)    =   4039.95
       Model |  17435.5509         9  1937.28343   Prob &gt; F        =    0.0000
    Residual |  55310.0589   115,342  .479530951   R-squared       =    0.2397
-------------+----------------------------------   Adj R-squared   =    0.2396
       Total |  72745.6098   115,351   .63064568   Root MSE        =    .69248

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      educat |
        &lt;HS  |  -.3882762   .0178644   -21.73   0.000    -.4232902   -.3532622
        HS+  |  -.0839435   .0104229    -8.05   0.000    -.1043722   -.0635149
         BA  |   .6145964   .0109763    55.99   0.000     .5930831    .6361097
         PG  |   .9055692   .0141961    63.79   0.000      .877745    .9333933
             |
       exper |   .0182621   .0003709    49.24   0.000     .0175351    .0189891
             |
      educat#|
     c.exper |
        &lt;HS  |    .001037   .0007627     1.36   0.174     -.000458    .0025319
        HS+  |   .0095156   .0005186    18.35   0.000     .0084991    .0105321
         BA  |  -.0032067   .0005743    -5.58   0.000    -.0043324   -.0020811
         PG  |  -.0051215   .0007698    -6.65   0.000    -.0066302   -.0036128
             |
       _cons |   6.101809   .0077485   787.48   0.000     6.086622    6.116996
------------------------------------------------------------------------------

 ( 1)  1.educat#c.exper = 0
 ( 2)  3.educat#c.exper = 0
 ( 3)  4.educat#c.exper = 0
 ( 4)  5.educat#c.exper = 0

       F(  4,115342) =  178.34
            Prob &gt; F =    0.0000</code></pre>
</div>
</div>
<p><strong>12.</strong> Compute the relevant Chi-squared distributed test statistic and corresponding p-value for the above test, assuming <span class="math inline">\(n\)</span> is large (enough).</p>
<div id="de226231" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> Cstat = Fstat*(DOFr-DOFu)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> pval = <span class="fu">chi2tail</span>(DOFr-DOFu,Cstat)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scalar</span> <span class="ot">list</span> Cstat pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Cstat =  713.37597
      pval =  4.42e-153</code></pre>
</div>
</div>
<p><strong>13.</strong> Using the data from Problem Set 2, estimate the simple linear regression model using OLS,</p>
<p><span class="math display">\[
  \ln(Wage_i) = \beta_0 + \beta_1 Educ_i + \beta_2 Female_i + \varepsilon_i
\]</span></p>
<div id="63b7778c" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"$rootdir/problem-sets/ps-2/problem-set-2-data.dta"</span>, <span class="kw">clear</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> lwage educ female</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">est</span> sto ols</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>estadd <span class="fu">scalar</span> sigma = <span class="fu">e</span>(rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(PSID wage data 1976-82 from Baltagi and Khanti-Akom (1990))

      Source |       SS           df       MS      Number of obs   =     4,165
-------------+----------------------------------   F(2, 4162)      =    732.99
       Model |  231.021419         2   115.51071   Prob &gt; F        =    0.0000
    Residual |  655.883483     4,162  .157588535   R-squared       =    0.2605
-------------+----------------------------------   Adj R-squared   =    0.2601
       Total |  886.904902     4,164  .212993492   Root MSE        =    .39697

------------------------------------------------------------------------------
       lwage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0651382   .0022066    29.52   0.000     .0608121    .0694642
      female |  -.4737645   .0194589   -24.35   0.000    -.5119143   -.4356147
       _cons |    5.89297   .0290891   202.58   0.000      5.83594        5.95
------------------------------------------------------------------------------

added scalar:
              e(sigma) =  .39697422</code></pre>
</div>
</div>
<p><strong>14.</strong> Estimate the Mincer equation using Maximum Likelihood. Take a look at <a href="https://www.stata.com/manuals13/rmlexp.pdf" class="uri">https://www.stata.com/manuals13/rmlexp.pdf</a>, the documentation for the <code>mlexp</code> command. It has a discussion on estimating the CLRM using ML.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div id="08b8bbe5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mlexp (<span class="fu">ln</span>(<span class="fu">normalden</span>(lwage, {<span class="kw">xb</span>: educ female <span class="dt">_cons</span>}, <span class="fu">exp</span>({theta}))))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ereturn</span> <span class="ot">list</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">nlcom</span> (sigma: <span class="fu">exp</span>(_b[/theta]))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>estadd <span class="fu">scalar</span> sigma = <span class="fu">r</span>(b)[1,1]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>eststo <span class="kw">ml</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Initial:      Log likelihood = -97095.356
Alternative:  Log likelihood = -35297.969
Rescale:      Log likelihood = -12999.606
Rescale eq:   Log likelihood = -7350.6222
Iteration 0:  Log likelihood = -7350.6222  (not concave)
Iteration 1:  Log likelihood =  -3936.054  
Iteration 2:  Log likelihood = -2187.1092  (backed up)
Iteration 3:  Log likelihood = -2073.0429  
Iteration 4:  Log likelihood = -2060.4271  
Iteration 5:  Log likelihood = -2060.4019  
Iteration 6:  Log likelihood = -2060.4019  

Maximum likelihood estimation

Log likelihood = -2060.4019                              Number of obs = 4,165

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
xb           |
        educ |   .0651382   .0022058    29.53   0.000      .060815    .0694614
      female |  -.4737645   .0194519   -24.36   0.000    -.5118895   -.4356396
       _cons |    5.89297   .0290786   202.66   0.000     5.835977    5.949963
-------------+----------------------------------------------------------------
      /theta |  -.9242442   .0109566   -84.35   0.000    -.9457188   -.9027696
------------------------------------------------------------------------------

scalars:
               e(rank) =  4
                  e(N) =  4165
                 e(ic) =  6
                  e(k) =  4
               e(k_eq) =  2
          e(converged) =  1
                 e(rc) =  0
                 e(ll) =  -2060.40189888505
              e(k_aux) =  1
               e(df_m) =  4
         e(k_eq_model) =  0

macros:
            e(cmdline) : "mlexp (ln(normalden(lwage, {xb: educ female _cons.."
                e(cmd) : "mlexp"
            e(predict) : "mlexp_p"
          e(estat_cmd) : "mlexp_estat"
       e(marginsnotok) : "SCores"
          e(marginsok) : "default xb"
        e(marginsprop) : "nochainrule"
               e(lexp) : "ln(normalden(lwage,{xb:},exp({theta:})))"
             e(params) : "xb:educ xb:female xb:_cons theta:_cons"
                e(opt) : "moptimize"
                e(vce) : "oim"
          e(ml_method) : "lf0"
          e(technique) : "nr"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 4
                  e(V) :  4 x 4
               e(init) :  1 x 4
               e(ilog) :  1 x 20
           e(gradient) :  1 x 4

functions:
             e(sample)   

       sigma: exp(_b[/theta])

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
       sigma |   .3968312   .0043479    91.27   0.000     .3883094     .405353
------------------------------------------------------------------------------

added scalar:
              e(sigma) =  .39683123</code></pre>
</div>
</div>
<p><strong>15.</strong> Estimate the Mincer equation using Method of Moments. You can use the <code>gmm</code> command in Stata. Hint: the regressors will be their own instruments and use the <code>onestep</code> option.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div id="0595e721" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>gmm (lwage - {<span class="kw">xb</span>: educ female <span class="dt">_cons</span>}), instruments(educ female) onestep</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>eststo mm</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>esttab ols <span class="kw">ml</span> mm, se <span class="kw">drop</span>(theta:<span class="dt">_cons</span>) <span class="fu">scalar</span>(<span class="kw">N</span> sigma) mtitle(OLS ML MM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Step 1
Iteration 0:  GMM criterion Q(b) =  44.629069  
Iteration 1:  GMM criterion Q(b) =  2.101e-24  
Iteration 2:  GMM criterion Q(b) =  1.368e-31  

note: model is exactly identified.

GMM estimation 

Number of parameters =   3
Number of moments    =   3
Initial weight matrix: Unadjusted                 Number of obs   =      4,165

------------------------------------------------------------------------------
             |               Robust
             | Coefficient  std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0651382   .0023187    28.09   0.000     .0605935    .0696828
      female |  -.4737645   .0177811   -26.64   0.000    -.5086148   -.4389143
       _cons |    5.89297   .0300924   195.83   0.000      5.83399     5.95195
------------------------------------------------------------------------------
Instruments for equation 1: educ female _cons

------------------------------------------------------------
                      (1)             (2)             (3)   
                      OLS              ML              MM   
------------------------------------------------------------
main                                                        
educ               0.0651***       0.0651***       0.0651***
                (0.00221)       (0.00221)       (0.00232)   

female             -0.474***       -0.474***       -0.474***
                 (0.0195)        (0.0195)        (0.0178)   

_cons               5.893***        5.893***        5.893***
                 (0.0291)        (0.0291)        (0.0301)   
------------------------------------------------------------
N                    4165            4165            4165   
sigma               0.397           0.397                   
------------------------------------------------------------
Standard errors in parentheses
* p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001</code></pre>
</div>
</div>
</section>
<section id="postamble" class="level2">
<h2 class="anchored" data-anchor-id="postamble">Postamble</h2>
<div id="d0a379d6" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">close</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>You can also look at the following resource for a more flexible approach to ML estimation in Stata: <a href="https://www.stata.com/features/overview/maximum-likelihood-estimation/" class="uri">https://www.stata.com/features/overview/maximum-likelihood-estimation/</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Here is a resource on GMM in Stata: <a href="https://www.stata.com/features/overview/generalized-method-of-moments/" class="uri">https://www.stata.com/features/overview/generalized-method-of-moments/</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>