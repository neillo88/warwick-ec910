<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Revision Questions – EC910</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EC910</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lecture-handouts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lecture Handouts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lecture-handouts">    
        <li>
    <a class="dropdown-item" href="./handout-1.html">
 <span class="dropdown-text">Handout 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-2.html">
 <span class="dropdown-text">Handout 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-3.html">
 <span class="dropdown-text">Handout 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-4.html">
 <span class="dropdown-text">Handout 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-5.html">
 <span class="dropdown-text">Handout 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-6.html">
 <span class="dropdown-text">Handout 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-7.html">
 <span class="dropdown-text">Handout 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./handout-8.html">
 <span class="dropdown-text">Handout 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-problem-sets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Problem Sets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-problem-sets">    
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1.html">
 <span class="dropdown-text">Problem Set 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-sets/ps-1/problem-set-1-solutions.html">
 <span class="dropdown-text">Problem Set 1 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2.html">
 <span class="dropdown-text">Problem Set 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-2-solutions.html">
 <span class="dropdown-text">Problem Set 2 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-3.html">
 <span class="dropdown-text">Problem Set 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-3-solutions.html">
 <span class="dropdown-text">Problem Set 3 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-4.html">
 <span class="dropdown-text">Problem Set 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-4-solutions.html">
 <span class="dropdown-text">Problem Set 4 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-5.html">
 <span class="dropdown-text">Problem Set 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-5-solutions.html">
 <span class="dropdown-text">Problem Set 5 (Solutions)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-6.html">
 <span class="dropdown-text">Problem Set 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./problem-set-6-solutions.html">
 <span class="dropdown-text">Problem Set 6 (Solutions)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-additional-material" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Additional Material</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-additional-material">    
        <li>
    <a class="dropdown-item" href="./material-cef.html">
 <span class="dropdown-text">Conditional Expectation Function</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-interpretation.html">
 <span class="dropdown-text">Interpreting Linear Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-dummy.html">
 <span class="dropdown-text">Dummy Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-linearalgebra.html">
 <span class="dropdown-text">Linear Algebra</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./material-inference.html">
 <span class="dropdown-text">Statistical Inference</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-revision" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Revision</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-revision">    
        <li>
    <a class="dropdown-item" href="./revision.html">
 <span class="dropdown-text">Revision</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basics" id="toc-basics" class="nav-link active" data-scroll-target="#basics"><span class="header-section-number">1</span> Basics</a></li>
  <li><a href="#clrm" id="toc-clrm" class="nav-link" data-scroll-target="#clrm"><span class="header-section-number">2</span> CLRM</a></li>
  <li><a href="#ols" id="toc-ols" class="nav-link" data-scroll-target="#ols"><span class="header-section-number">3</span> OLS</a></li>
  <li><a href="#linear-tests" id="toc-linear-tests" class="nav-link" data-scroll-target="#linear-tests"><span class="header-section-number">4</span> Linear Tests</a></li>
  <li><a href="#panel-data" id="toc-panel-data" class="nav-link" data-scroll-target="#panel-data"><span class="header-section-number">5</span> Panel Data</a></li>
  <li><a href="#binary-outcome-models" id="toc-binary-outcome-models" class="nav-link" data-scroll-target="#binary-outcome-models"><span class="header-section-number">6</span> Binary Outcome Models</a></li>
  <li><a href="#endogenous-selection-models" id="toc-endogenous-selection-models" class="nav-link" data-scroll-target="#endogenous-selection-models"><span class="header-section-number">7</span> Endogenous Selection Models</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="revision.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Revision Questions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="basics" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="basics"><span class="header-section-number">1</span> Basics</h2>
<ol type="1">
<li><p>Consider two random <span class="math inline">\(k\)</span>-dimension vectors <span class="math inline">\(\{X,Y\}\)</span> and non-random <span class="math inline">\(k\times k\)</span> matrices <span class="math inline">\(\{A,B\}\)</span>. Show,</p>
<p>1.1. <span class="math inline">\(Var(AX) = A Var(X) A'\)</span></p>
<p>1.2. <span class="math inline">\(Var(AX+b) = A Var(X) A'\)</span> for non-random <span class="math inline">\(k\)</span>-dimension vector <span class="math inline">\(b\)</span></p>
<p>1.3. <span class="math inline">\(Cov(AX,BY) = A Cov(X,Y) B'\)</span></p></li>
<li><p>Suppose <span class="math inline">\(X\sim N(\mu,\Sigma)\)</span>, with <span class="math inline">\(X\in \mathbb{R}^k\)</span>. Find the distribution, <span class="math inline">\(Y = AX + b\)</span>, for non-random <span class="math inline">\(k\times k\)</span> matrix <span class="math inline">\(A\)</span> and non-random <span class="math inline">\(k\)</span>-dimension vector <span class="math inline">\(b\)</span>.</p></li>
</ol>
</section>
<section id="clrm" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="clrm"><span class="header-section-number">2</span> CLRM</h2>
<ol type="1">
<li><p>Which of the CLRM assumptions is required for identification of <span class="math inline">\(\beta\)</span>? Demonstrate this claim.</p></li>
<li><p>Provide an example of a model that is non-linear in regressors, but linear in parameters. Similarly, provide an example of a model that is linear in regressors, but non-linear in parameters.</p></li>
<li><p>Suppose, the true data generating process was given by,</p>
<p><span class="math display">\[
Y = X\beta + \epsilon
\]</span> where <span class="math inline">\(E[\epsilon|X] = \alpha\)</span> and <span class="math inline">\(X\)</span> included a constant term with parameter <span class="math inline">\(\beta_1\)</span>. Is <span class="math inline">\(\beta_1\)</span> identified?</p></li>
<li><p>Given the result <span class="math inline">\(\beta = E[X_iX_i']^{-1}E[X_iY_i]\)</span>. With two regressors, <span class="math inline">\(X_i = [1\;X_{2i}]'\)</span>, show</p>
<p>4.1. <span class="math inline">\(\beta_2 = \frac{Cov(X_{2i},Y_i)}{Var(X_{2i})}\)</span></p>
<p>4.2. <span class="math inline">\(\beta_1 = E[Y_i]-\beta_2E[X_i]\)</span></p></li>
</ol>
</section>
<section id="ols" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="ols"><span class="header-section-number">3</span> OLS</h2>
<ol type="1">
<li><p>Consider the projection matrices <span class="math inline">\(P_X = X(X'X)^{-1}X'\)</span> and <span class="math inline">\(M_X = I_n-P_X\)</span>. Show,</p>
<p>1.1. <span class="math inline">\(P_XX = X\)</span></p>
<p>1.2. <span class="math inline">\(M_XX = 0\)</span></p>
<p>1.3. <span class="math inline">\(P_XM_X = 0\)</span></p>
<p>1.4. <span class="math inline">\(X'P_X=X'\)</span></p></li>
<li><p>Show that <span class="math inline">\(X'X\)</span>, where <span class="math inline">\(X\)</span> is a <span class="math inline">\(n\times k\)</span> random matrix, can be expressed as <span class="math inline">\(\sum_{i=1}^nX_iX_i'\)</span>, where <span class="math inline">\(X_i\)</span> is a <span class="math inline">\(k\times 1\)</span> vector.</p></li>
<li><p>Consider the partitioned regression model, <span class="math display">\[
Y = X_1\beta_1 + X_2\beta_2 + u
\]</span> Show,</p>
<p>3.1. <span class="math inline">\(E[\hat{\beta}_1|X]=\beta_1\)</span> where <span class="math inline">\(\hat{\beta}_1 = (X_1'M_2X_1)^{-1}X_1'M_2Y\)</span>.</p>
<p>3.2. Write down the conditional variance of the OLS estimator for <span class="math inline">\(\beta_1\)</span>, assuming homoskedasticity: <span class="math inline">\(E[uu'|X]=\sigma^2 I_n\)</span>.</p>
<p>3.3. Write down the conditional variance of the OLS estimator for <span class="math inline">\(\beta_1\)</span>, assuming heteroskedasticity: <span class="math inline">\(E[uu'|X]=\Omega\)</span>.</p></li>
<li><p>Demonstrate the BLUE result: the OLS estimator (<span class="math inline">\(\hat{\beta}\)</span>) is the Best Linear Unbiased Estimator. Consider the alternative unbiased, linear estimator <span class="math inline">\(b=AY\)</span>; such that, <span class="math display">\[
\begin{aligned}
E[b|X] = \beta
\end{aligned}
\]</span></p>
<p>4.1. Show that since <span class="math inline">\(b\)</span> is unbiased, it must be that <span class="math inline">\(AX = I_k\)</span>.</p>
<p>4.2. Using the above result, show that under CLRM 1-6 (i.e., including homoskedasticity), <span class="math display">\[
Cov(\hat{\beta},b|X) = Var(\hat{\beta}|X)
\]</span></p>
<p>4.2. Show that <span class="math inline">\(Var(b|X)-Var(\hat{\beta}|X)\geq 0\)</span> (i.e.&nbsp;a positive semi-definite matrix), by solving for <span class="math display">\[
Var(\hat{\beta}-b|X)
\]</span></p></li>
<li><p>Consider the GLS estimator (<span class="math inline">\(\tilde{\beta}\)</span>), which solves the problem</p>
<p><span class="math display">\[
\underset{b}{\min}\; (Y-Xb)'\Omega^{-1}(Y-Xb)
\]</span></p>
<p>where <span class="math inline">\(E[\varepsilon \varepsilon'|X]=\Omega\)</span>.</p>
<p>5.1. Show that <span class="math inline">\(Var(\hat{\beta}|X)-Var(\tilde{\beta}|X)\geq 0\)</span>, where <span class="math inline">\(\hat{\beta}\)</span> is the OLS estimator.</p>
<p>5.2. Under which assumption are the two estimators equivalent?</p></li>
</ol>
</section>
<section id="linear-tests" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="linear-tests"><span class="header-section-number">4</span> Linear Tests</h2>
<ol type="1">
<li><p>Under CLRM 1-6, solve for the finite sample distribution of <span class="math inline">\(R\hat{beta}\)</span>, where <span class="math inline">\(R\)</span> is non-random <span class="math inline">\(k\times k\)</span> matrix.</p></li>
<li><p>Consider the multiple, linear hypotheses:</p>
<p><span class="math display">\[
\begin{aligned}
H_0:\;&amp; \beta_2 -4\beta_4 = 1 \\
&amp; \beta_3 = 3 \\
&amp; \beta_5 = \beta_6
\end{aligned}
\]</span></p>
<p>2.1. Write the 4 hypotheses in the form <span class="math inline">\(R\beta = r\)</span>.</p>
<p>2.2. Write down the F-statistic for the test (assuming homoskedasticity) as well as it’s finite sample distribution.</p>
<p>2.3. What is the asymptotic distribution of this test statistic.</p>
<p>2.4. For a linear model with <span class="math inline">\(k=6\)</span>, write the restricted model corresponding to the above hypotheses.</p></li>
<li><p>Consider the model of household food expenditure,</p>
<p><span class="math display">\[
foodexp_i = \beta_1 + \beta_2 inc_i + \beta_3hhsize_i + \beta_4hhsize^2_i + \varepsilon_i
\]</span></p>
<p>3.1. Suppose you wish to test the hypothesis of increasing returns to food consumption in the household: each additional household member is marginally cheaper to feed. Which is a more powerful test:</p>
<p><span class="math display">\[
H_0:\; \beta_4=0 \qquad \text{against}\qquad H_1:\; \beta_4\neq0
\]</span> or, <span class="math display">\[
H_0:\; \beta_4\geq 0 \qquad \text{against}\qquad H_1:\; \beta_4&lt;0
\]</span></p>
<p>3.2. Transform the model to test the hypothesis <span class="math inline">\(H_0: -\beta_3/\beta_4 = 5\)</span>, using just the coefficient on the variable <span class="math inline">\(hhsize\)</span>.</p>
<p>3.3. Transform the model to test the same hypothesis, using just the coefficient on the variable <span class="math inline">\(hhsize^2\)</span>.</p></li>
</ol>
</section>
<section id="panel-data" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="panel-data"><span class="header-section-number">5</span> Panel Data</h2>
<ol type="1">
<li><p>Show that <span class="math inline">\(\tilde{Y}_i = Y_i - \bar{Y}_i\)</span>, where <span class="math inline">\(\bar{Y}_i = \frac{1}{T}\sum_{t=1}^T Y_{it}\)</span>, can be written as <span class="math inline">\(Y = M_\ell Y_i\)</span>, where <span class="math inline">\(M_\ell = \ell (\ell'\ell)^{-1}\ell'\)</span> and <span class="math inline">\(\ell\)</span> is a <span class="math inline">\(T\times 1\)</span> vector of 1’s.</p></li>
<li><p>Show that <span class="math inline">\(X'X\)</span>, where <span class="math inline">\(X\)</span> is a <span class="math inline">\(nT\times k\)</span> random matrix, can be expressed as <span class="math inline">\(\sum_{i=1}^nX_i'X_i\)</span>, where <span class="math inline">\(X_i\)</span> is a <span class="math inline">\(T\times k\)</span> matrix.</p></li>
<li><p>Show that <span class="math inline">\(I_n\otimes M_\ell\)</span> is an idempotent matrix and <span class="math inline">\(\sum_{i=1}^n\tilde{X}_i'\tilde{X}_i=X'(I_n\otimes M_\ell)X\)</span>.</p></li>
<li><p>Show that for T=3, <span class="math inline">\(D'(DD')^{-1}D = M_\ell\)</span>.</p></li>
<li><p>Demonstrate that the OLS estimator of the ‘within-unit’ transformed model is unbiased. Is it efficient?</p></li>
<li><p>Conditional variance of random effects model,</p>
<p>6.1. Solve for <span class="math inline">\(Var(\hat{\beta}^{OLS}|X)\)</span>, the variance of the (‘pooled’) OLS estimator for the random effects model.</p>
<p>6.2. Solve for <span class="math inline">\(Var(\hat{\beta}^{GLS}|X)\)</span>, the variance of the GLS estimator for the random effects model.</p>
<p>6.3. Verify that <span class="math inline">\(Var(\hat{\beta}^{OLS}|X)-Var(\hat{\beta}^{GLS}|X)\geq 0\)</span>, is a positive-semidefinite matrix.</p></li>
<li><p>Conditional variance of first-differenced transformation</p>
<p>7.1. Solve for <span class="math inline">\(Var(\hat{\beta}^{FD-OLS}|X)\)</span>, the variance of the OLS estimator for the FD transformation.</p>
<p>7.2. Solve for <span class="math inline">\(Var(\hat{\beta}^{FD-GLS}|X)\)</span>, the variance of the GLS estimator for the FD transformation.</p>
<p>7.3. Verify that <span class="math inline">\(Var(\hat{\beta}^{FD-OLS}|X)-Var(\hat{\beta}^{FD-GLS}|X)\geq 0\)</span>, is a positive-semidefinite matrix.</p></li>
<li><p>Why is it important that the assumed model underlying the ‘pooled’ OLS estimator and ‘within’ OLS estimator are the same in the Hausman test? That is, why cannot we not compare the LSDV estimator of the fixed-effects model with the ‘pooled’ OLS estimator?</p></li>
<li><p>What is the purpose of the Mundlack correction?</p></li>
</ol>
</section>
<section id="binary-outcome-models" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="binary-outcome-models"><span class="header-section-number">6</span> Binary Outcome Models</h2>
<ol type="1">
<li><p>Consider the Logit model.</p>
<p>1.1. Write down the likelihood function.</p>
<p>1.2. State the maximization problem that solves for ML estimator.</p>
<p>1.3. Solve for the F.O.C.s of the ML problem.</p>
<p>1.4. Solve for the asymptotic variance-covariance matrix of <span class="math inline">\(\hat{\beta}^{ML}\)</span>.</p></li>
<li><p>Consider the Probit model.</p>
<p>2.1. Write down the likelihood function.</p>
<p>2.2. State the maximization problem that solves for ML estimator.</p>
<p>2.3. Solve for the F.O.C.s of the ML problem.</p>
<p>2.4. Solve for the asymptotic variance-covariance matrix of <span class="math inline">\(\hat{\beta}^{ML}\)</span>.</p></li>
<li><p>From the proof of the asymptotic normality, show</p>
<p><span class="math display">\[
E\bigg[\frac{\partial^2 f(Y_i|X_i;\beta_0)/\partial\beta\partial\beta'}{f(Y_i|X_i;\beta_0)}\bigg]=0
\]</span></p></li>
</ol>
<div id="14229188" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
</div>
<div id="5dc1b352" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> eduyrs = .</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = .3 <span class="kw">if</span> grade92==31</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 3.2 <span class="kw">if</span> grade92==32</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 7.2 <span class="kw">if</span> grade92==33</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 7.2 <span class="kw">if</span> grade92==34</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 9  <span class="kw">if</span> grade92==35</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 10 <span class="kw">if</span> grade92==36</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 11 <span class="kw">if</span> grade92==37</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 12 <span class="kw">if</span> grade92==38</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 12 <span class="kw">if</span> grade92==39</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 13 <span class="kw">if</span> grade92==40</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 14 <span class="kw">if</span> grade92==41</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 14 <span class="kw">if</span> grade92==42</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 16 <span class="kw">if</span> grade92==43</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==44</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==45</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> eduyrs = 18 <span class="kw">if</span> grade92==46</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    lab <span class="kw">var</span> eduyrs <span class="st">"completed education"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> exper = age-(eduyrs+6)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">replace</span> exper=0 <span class="kw">if</span> exper&lt;0</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> <span class="kw">if</span> <span class="fu">inrange</span>(age,18,54)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> lnwage = <span class="fu">ln</span>(earnwke)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> exper2 = exper^2</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> employed = lnwage!=0</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> married = marital&lt;=3</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> female = sex==2</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">gen</span> child = ownchild&gt;=1</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">logit</span> employed eduyrs exper exper2 i.married i.female##i.child </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 0:  Log likelihood = -209.35624  
Iteration 1:  Log likelihood = -205.66439  
Iteration 2:  Log likelihood = -205.27888  
Iteration 3:  Log likelihood = -205.27756  
Iteration 4:  Log likelihood = -205.27756  

Logistic regression                                    Number of obs = 165,038
                                                       LR chi2(7)    =    8.16
                                                       Prob &gt; chi2   =  0.3189
Log likelihood = -205.27756                            Pseudo R2     =  0.0195

------------------------------------------------------------------------------
    employed | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      eduyrs |  -.2139028   .0990457    -2.16   0.031    -.4080287   -.0197768
       exper |   .0408304   .0861167     0.47   0.635    -.1279552    .2096161
      exper2 |  -.0012522   .0024549    -0.51   0.610    -.0060637    .0035593
   1.married |  -.1047635   .5283537    -0.20   0.843    -1.140318    .9307907
    1.female |   .0208576   .5035107     0.04   0.967    -.9660052    1.007721
     1.child |   .4950251   .7490084     0.66   0.509    -.9730045    1.963055
             |
female#child |
        1 1  |   .6419965   1.046185     0.61   0.539    -1.408489    2.692482
             |
       _cons |   11.64254   1.476069     7.89   0.000     8.749502    14.53559
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><p>Consider the logit model output above, estimated using the dataset from Problem Set 4. The sample and variables are defined as in PS 4.</p>
<p>4.1. Compute the marginal effect of an additional year of education on the probability of being employed for a childless, unmarried, female with 15 years of education and 5 years of (potential) experience.</p>
<p>4.2. Compute the marginal effect of being married for a male with children, 12 years of education and 10 years of experience.</p></li>
</ol>
</section>
<section id="endogenous-selection-models" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="endogenous-selection-models"><span class="header-section-number">7</span> Endogenous Selection Models</h2>
<ol type="1">
<li><p>Consider the endogenous the right-censored Tobit model. The observed distribution is,</p>
<p><span class="math display">\[
f(y) = \begin{cases} f^*(y) \qquad \text{for} \quad y &lt;0 \\
F^*(0)  \qquad \text{for} \quad y=0 \\
0 \qquad \text{for} \quad y&gt;0
\end{cases}
\]</span> Suppose, <span class="math inline">\(Y^* = X_i'\beta + \varepsilon_i\)</span>, where the error term has a normally distributed (conditional on <span class="math inline">\(X\)</span>).</p>
<p>1.1. Solve for <span class="math inline">\(E[Y_i|Y_i&lt;0]\)</span></p>
<p>1.2. Write down the likelihood function of the observed data.</p>
<p>1.3. Solve for <span class="math inline">\(\frac{\partial E[Y_i|X_i,Y_i&lt;0]}{\partial X_i}\)</span></p>
<p>1.4. Solve for <span class="math inline">\(\frac{\partial E[Y_i|X_i]}{\partial X_i}\)</span></p>
<p>1.5. How do the answers compare to the case where <span class="math inline">\(Y\)</span> is left-censored at 0?</p></li>
</ol>
<div id="d2152e5e" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">probit</span> employed eduyrs exper exper2 i.married i.female##i.child </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 0:  Log likelihood = -209.35624  
Iteration 1:  Log likelihood = -205.60572  
Iteration 2:  Log likelihood = -205.33806  
Iteration 3:  Log likelihood = -205.33756  
Iteration 4:  Log likelihood = -205.33756  

Probit regression                                      Number of obs = 165,038
                                                       LR chi2(7)    =    8.04
                                                       Prob &gt; chi2   =  0.3293
Log likelihood = -205.33756                            Pseudo R2     =  0.0192

------------------------------------------------------------------------------
    employed | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      eduyrs |  -.0544498   .0255841    -2.13   0.033    -.1045937   -.0043059
       exper |   .0095296   .0223186     0.43   0.669    -.0342139    .0532732
      exper2 |  -.0002998   .0006319    -0.47   0.635    -.0015382    .0009387
   1.married |  -.0259376   .1384233    -0.19   0.851    -.2972423    .2453672
    1.female |   .0049027   .1321027     0.04   0.970    -.2540139    .2638192
     1.child |   .1297358   .1937444     0.67   0.503    -.2499962    .5094679
             |
female#child |
        1 1  |   .1540261   .2634162     0.58   0.559    -.3622602    .6703123
             |
       _cons |   4.341448   .3821216    11.36   0.000     3.592503    5.090392
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><p>Consider an endogenous threshold model, for (log of) employee earnings. Included in the model is a linear term in years of education, quadratic terms in years of (potential) experience, a married dummy-variable, and a female dummy-variable.</p>
<p>2.1. Consider the output above from the selection equation, which includes an additional interaction between gender and presence of children (under 18). Compute the Inverse Mills Ratio for a married women, with children, 15 years of education and 8 years of experience.</p>
<p>2.2. Write down the likelihood function of the observed outcomes: <span class="math inline">\([ln(wage_i),Employed_i]\)</span>. Where the latter is a dummy variable indicating employment (positive earnings).</p>
<p>2.3. The Heckit output is given below. What can you conclude regarding selection into employment. And, under what assumptions.</p>
<p>2.4. Does the interaction bewteen gender and parenthood belong in the main equation?</p></li>
</ol>
<div id="9ca57ff9" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">heckman</span> lnwage eduyrs exper exper2 i.married i.female, select(employed = exper exper2 i.married i.female##i.child) twostep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>note: two-step estimate of rho = 19.806689 is being truncated to 1

Heckman selection model -- two-step estimates   Number of obs     =    115,352
(regression model with sample selection)              Selected    =    115,331
                                                      Nonselected =         21

                                                Wald chi2(5)      =       4.66
                                                Prob &gt; chi2       =     0.4590

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
lnwage       |
      eduyrs |   .1289768   .0827439     1.56   0.119    -.0331983     .291152
       exper |   .0559093   .0878259     0.64   0.524    -.1162263    .2280449
      exper2 |  -.0010644   .0023925    -0.44   0.656    -.0057535    .0036248
   1.married |   .1015441   .4325466     0.23   0.814    -.7462316    .9493198
    1.female |  -.3315884   .3953545    -0.84   0.402    -1.106469    .4432921
       _cons |   4.387386   1.504299     2.92   0.004     1.439014    7.335759
-------------+----------------------------------------------------------------
employed     |
       exper |   .0079269   .0219371     0.36   0.718    -.0350691    .0509228
      exper2 |  -.0001872   .0006005    -0.31   0.755     -.001364    .0009897
   1.married |  -.0687001   .1375189    -0.50   0.617    -.3382323    .2008321
    1.female |   -.023606   .1337126    -0.18   0.860    -.2856778    .2384659
     1.child |   .1552287   .1938012     0.80   0.423    -.2246146    .5350721
             |
female#child |
        1 1  |   .1308613   .2683362     0.49   0.626    -.3950681    .6567907
             |
       _cons |   3.482178   .1598692    21.78   0.000      3.16884    3.795516
-------------+----------------------------------------------------------------
/mills       |
      lambda |   66.28671    929.642     0.07   0.943    -1755.778    1888.352
-------------+----------------------------------------------------------------
         rho |    1.00000
       sigma |  66.286706
------------------------------------------------------------------------------</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>