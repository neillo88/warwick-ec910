{
  "hash": "a9f9bf429c2e437cd407c165730d2490",
  "result": {
    "engine": "jupyter",
    "markdown": "---\nformat:\n    html: default\n    pdf: default\njupyter: nbstata  \n---\n\n\n\n\n\n\n# Problem Set 6\n\nThe purpose of the first part of this problem set is to estimate, interpret the results, and compare the results across different binary dependent variable models. In the second part you will estimate and compare different specifications of an endogenous selection model.\n\nFirst part will be discussed in week 9 and the second part in week 10 of this term.\n\nThe data file for this exercise is on Moodle: `mus16data.dta`. It is a subset of the data used by P. Deb, M. Munkin and P.K. Trivedi (2006): \"Bayesian Analysis of Two-Part Model with Endogeneity\", Journal of Applied Econometrics, 21, 1081-1100. Data is for 2001 and comes from the Medical Expenditure Survey. Sample has 3,328 observations.\n\nThe main outcome variable of interest is ambulatory expenditure (`ambexp`) and the regressors are given below.\n\nSince the expenditure data is skewed, we will be using the logged expenditure variable as our dependent variable. You should read Cameron A.C. and Trivedi, P.K. Micro-econometrics using Stata to see the pros and cons regarding whether to log the dependent variable or not.\n\nNote, there is one individual who has an `expenditure`=1 and this will get coded as 0 when variable is logged. Since it is only one individual, we will ignore the problem by not doing anything. If there are many individuals like this, you will need to see whether you can say why this might be the case.\n\n**Dependent variable**\n\n-   `ambexp`: Ambulatory medical expenditures (excluding dental and outpatient mental). There are 526 individuals with zero expenditure. There is one individual who has expenditure=$1. I am going to assume that this individual did not spend any money.\n\n-   `lambexp`: ln(`ambexp`) given `ambexp` > 0 ; missing otherwise\n\n-   `dambexp`: 1 if `ambexp` > 0 and 0 otherwise (binary indicator)\n\n**Regressors**\n\n-   `ins`: health insurance measures, either PPO or HMO type insurance\n\n-   `totchr`: health status measures: number of chronic diseases\n\n-   `age`: age age in years/10\n\n-   `female`: 1 for females, zero otherwise\n\n-   `educ`: years of schooling of decision maker\n\n-   `blhisp`: either black or Hispanic\n\n-   `income`: income in USD/1000\n\n## Preamble\n\n::: {#54763040 .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>\n```\n:::\n:::\n\n\nCreate a do-file for this problem set and include a preamble that sets the directory and opens the data. For example, \n\n::: {#2f014e23 .cell execution_count=2}\n``` {.stata .cell-code}\nclear \n//or, to remove all stored values (including macros, matrices, scalars, etc.) \n*clear all\n\n* Replace $rootdir with the relevant path to on your local harddrive.\ncd \"$rootdir/problem-sets/ps-6\"\n\ncap log close\nlog using problem-set-6-log.txt, replace\n\nuse mus16data.dta, clear\n```\n:::\n\n\n## Questions\n### Part 1\n\n**1.1.** Obtain and comment on the descriptive statistics for ambexp, lambexp, age, female, educ, blhisp, totchr, ins, income.\n\n**1.2.** Estimate a LP, Probit and a Logit model to explain dambexp. Store the $\\beta$ coefficients and report them in a table. \n\n**1.3.** Estimate the Marginal Effect at the Mean for each model, and report them in a table. You will want to use the `estpost margins` post-estimation command, with the relevant option for MEM. Pay special attention to the treatment of discrete regressors. Hint: check to see any differences in the estimated MEs based on whether you use factor notation; for example, `i.female` vs `female`. \n\n**1.4.** Estimate the Average Marginal Effect at the Mean for each model, and report them in a table.You will want to use the `estpost margins` post-estimation command, with the relevant option for AME.  \n\n**1.5.** Check to see how well the prodbit model predicts the outcome using the `estat classification` post-estimation command.\n\n**1.6.** Construct and interpret the LR test for the omission of income in the probit model. Do this in two ways: (1) using the post estimation `lrtest`; (2) manually recreate (1)'s results (both test-statistic and p-value).\n\n\n### Part 2\n\nEstimate the following models for `lambexp` treating the selection into non-zero `lambexp` value as endogenous using, both Heckman 2-step method and also MLE. \n\nIn the main data `lambexp` is missing for values of `ambexp`=0. Before proceeding, \n\n::: {#e2296a36 .cell execution_count=3}\n``` {.stata .cell-code}\nreplace lambexp = 0 if ambexp==0\n```\n:::\n\n\nThis will correction will also treat observations with `ambexp=1` as equivalent to =0; however, this is only a single observation. \n\n**2.1.** Estimate the Heckman 2-step estimator and store the results. In addition, store the Mills ratio as a separate variable. Use `income` as the excluded variable. This means that `income` appears in the selection equation, but NOT the main equation. \n\n**2.2.** Replicate these results by applying the following steps: (1) estimate the selection equation using a probit model; (2) create the mills ratio; (3) `compare` your mills ratio with the one stored above; (4) estimate the main equation, including the mills ratio.\n\n**2.3** Estimate the marginal effects of the selection equation. You can do this using the `estpost margins` command. This should correspond to a probit model estimation above. \n\n**2.4.** Estimate the Maximum Likelihood version of the Heckmann correction (with an excluded variable) and store the results. \n\n**2.5.** Now re-estimate the two-step and MLE approach without an excluded variable, storing the results each time. This means that the same set of regressors enter both equations. i.e. include income in the outcome equation.  \n\n**2.6.** Create a table that reports the four models alongside one another and compare the results. \n\n\n## Postamble\n\n::: {#9c3c6cbe .cell execution_count=4}\n``` {.stata .cell-code}\nlog close\n```\n:::\n\n\n",
    "supporting": [
      "problem-set-6_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}